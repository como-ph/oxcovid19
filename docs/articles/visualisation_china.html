<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Country level visualisation for Mainland China • oxcovid19</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Country level visualisation for Mainland China">
<meta property="og:description" content="oxcovid19">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oxcovid19</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/oxcovid19.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/database_access.html">OxCOVID19 Database Access</a>
    </li>
    <li>
      <a href="../articles/visualisation_china.html">Country level visualisation for Mainland China</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/como-ph/oxcovid19/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="visualisation_china_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Country level visualisation for Mainland China</h1>
                        <h4 class="author">Ernest Guevarra</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/como-ph/oxcovid19/blob/master/vignettes/visualisation_china.Rmd"><code>vignettes/visualisation_china.Rmd</code></a></small>
      <div class="hidden name"><code>visualisation_china.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we show how to perform the OxCOVID19 Database visualisation examples shown <a href="https://github.com/covid19db/examples/blob/master/data-plots/confirmed-adm-1-level-china.ipynb">here</a> using R and the <code>oxcovid19</code> package.</p>
<p>Here we further demonstrate the use of the <code>oxcovid19</code> functions in tandem with the <code>dplyr</code> functions to query the PostgreSQL server. In addition, we demonstrate the use of <code>sf</code> functions to retrieve the <code>administrative_division</code> which is a spatial layer of boundary shapes of various countries and various administrative units within countries.</p>
<div id="retrieving-epidemiology-data-for-single-source" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieving-epidemiology-data-for-single-source" class="anchor"></a>Retrieving epidemiology data for single source</h2>
<p>This is similar to what we have already demonstrated in previous vignettes. Here we retrieve the epidemiology table and query it for records coming from <code>CHN_ICL</code> source and for records at the subnational level for China.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">oxcovid19</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)

<span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">date</span>))
<span class="co">#&gt; # Source:     lazy query [?? x 15]</span>
<span class="co">#&gt; # Database:   postgres [covid19@covid19db.org:5432/covid19]</span>
<span class="co">#&gt; # Ordered by: desc(date)</span>
<span class="co">#&gt;    source date       country countrycode adm_area_1 adm_area_2 adm_area_3 tested</span>
<span class="co">#&gt;    &lt;chr&gt;  &lt;date&gt;     &lt;chr&gt;   &lt;chr&gt;       &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt;       &lt;int&gt;</span>
<span class="co">#&gt;  1 CHN_I… 2020-04-01 China   CHN         Shanxi     &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  2 CHN_I… 2020-04-01 China   CHN         Beijing    &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  3 CHN_I… 2020-03-31 China   CHN         Zhejiang   &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  4 CHN_I… 2020-03-31 China   CHN         Xizang     &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  5 CHN_I… 2020-03-31 China   CHN         Xinjiang … &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  6 CHN_I… 2020-03-31 China   CHN         Tianjin    &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  7 CHN_I… 2020-03-31 China   CHN         Sichuan    &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  8 CHN_I… 2020-03-31 China   CHN         Shanxi     &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt;  9 CHN_I… 2020-03-31 China   CHN         Shanghai   &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt; 10 CHN_I… 2020-03-31 China   CHN         Shandong   &lt;NA&gt;       &lt;NA&gt;           NA</span>
<span class="co">#&gt; # … with more rows, and 7 more variables: confirmed &lt;int&gt;, recovered &lt;int&gt;,</span>
<span class="co">#&gt; #   dead &lt;int&gt;, hospitalised &lt;int&gt;, hospitalised_icu &lt;int&gt;, quarantined &lt;int&gt;,</span>
<span class="co">#&gt; #   gid &lt;chr&gt;</span></pre></body></html></div>
</div>
<div id="extracting-only-recent-data---total-per-region" class="section level2">
<h2 class="hasAnchor">
<a href="#extracting-only-recent-data---total-per-region" class="anchor"></a>Extracting only recent data - total per region</h2>
<p>Then, here, we get the latest records for each subnational unit.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">chn_recent_region</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span>(<span class="no">adm_area_1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">date</span>) <span class="kw">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span>(<span class="no">date</span>), <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span>(<span class="no">date</span>, <span class="no">country</span>, <span class="no">adm_area_1</span>, <span class="no">confirmed</span>, <span class="no">recovered</span>, <span class="no">dead</span>, <span class="no">gid</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span>()</pre></body></html></div>
<pre><code>#&gt; # A tibble: 31 x 7
#&gt; # Groups:   adm_area_1 [31]
#&gt;    adm_area_1 date       country confirmed recovered  dead gid       
#&gt;    &lt;chr&gt;      &lt;date&gt;     &lt;chr&gt;       &lt;int&gt;     &lt;int&gt; &lt;int&gt; &lt;pq__text&gt;
#&gt;  1 Anhui      2020-03-31 China         990       984     6 {CHN.1_1} 
#&gt;  2 Beijing    2020-04-01 China         580       418     8 {CHN.2_1} 
#&gt;  3 Chongqing  2020-03-31 China         579       570     6 {CHN.3_1} 
#&gt;  4 Fujian     2020-03-30 China         343       295     1 {CHN.4_1} 
#&gt;  5 Gansu      2020-03-31 China         137       127     2 {CHN.5_1} 
#&gt;  6 Guangdong  2020-03-31 China        1501      1357     8 {CHN.6_1} 
#&gt;  7 Guangxi    2020-03-31 China         255       250     2 {CHN.7_1} 
#&gt;  8 Guizhou    2020-03-31 China         147       144     2 {CHN.8_1} 
#&gt;  9 Hainan     2020-03-30 China         168       162     6 {CHN.9_1} 
#&gt; 10 Hebei      2020-03-30 China         321       310     6 {CHN.10_1}
#&gt; # … with 21 more rows</code></pre>
</div>
<div id="retrieving-administrative-division-level-1-for-single-country" class="section level2">
<h2 class="hasAnchor">
<a href="#retrieving-administrative-division-level-1-for-single-country" class="anchor"></a>Retrieving administrative division level 1 for single country</h2>
<p>In this step, we retrieve the spatial layer for China at subnational level from the server using the function <code>get_layer</code>. The resulting output is an <code>sf</code> class object.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">chn_admin_1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_layer.html">get_layer</a></span>(<span class="kw">ccode</span> <span class="kw">=</span> <span class="st">"CHN"</span>, <span class="kw">adm</span> <span class="kw">=</span> <span class="fl">1</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/compute.html">collect</a></span>()</pre></body></html></div>
<pre><code>#&gt; Simple feature collection with 31 features and 14 fields
#&gt; geometry type:  GEOMETRY
#&gt; dimension:      XY
#&gt; bbox:           xmin: 73.5577 ymin: 18.15931 xmax: 134.7716 ymax: 53.56004
#&gt; geographic CRS: WGS 84
#&gt; First 10 features:
#&gt;    country countrycode countrycode_alpha2 adm_level adm_area_1 adm_area_1_code
#&gt; 1    China         CHN                 CN         1    Guizhou         CHN.8_1
#&gt; 2    China         CHN                 CN         1      Anhui         CHN.1_1
#&gt; 3    China         CHN                 CN         1    Beijing         CHN.2_1
#&gt; 4    China         CHN                 CN         1  Chongqing         CHN.3_1
#&gt; 5    China         CHN                 CN         1     Fujian         CHN.4_1
#&gt; 6    China         CHN                 CN         1      Gansu         CHN.5_1
#&gt; 7    China         CHN                 CN         1  Guangdong         CHN.6_1
#&gt; 8    China         CHN                 CN         1    Guangxi         CHN.7_1
#&gt; 9    China         CHN                 CN         1     Hainan         CHN.9_1
#&gt; 10   China         CHN                 CN         1      Hebei        CHN.10_1
#&gt;    adm_area_2 adm_area_2_code adm_area_3 adm_area_3_code      gid latitude
#&gt; 1        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.8_1 26.81518
#&gt; 2        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.1_1 31.82579
#&gt; 3        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.2_1 40.18491
#&gt; 4        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.3_1 30.05865
#&gt; 5        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.4_1 26.08106
#&gt; 6        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.5_1 37.82079
#&gt; 7        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.6_1 23.33520
#&gt; 8        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.7_1 23.82701
#&gt; 9        &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;  CHN.9_1 19.19553
#&gt; 10       &lt;NA&gt;            &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt; CHN.10_1 39.54574
#&gt;    longitude
#&gt; 1   106.8741
#&gt; 2   117.2262
#&gt; 3   116.4107
#&gt; 4   107.8748
#&gt; 5   117.9899
#&gt; 6   100.9339
#&gt; 7   113.4153
#&gt; 8   108.7866
#&gt; 9   109.7458
#&gt; 10  116.1301
#&gt;                                                                                                                                                                                                                                             properties
#&gt; 1                                          {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.8_1", "HASC_1": "CN.GZ", "NAME_0": "China", "NAME_1": "Guizhou", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "貴州|贵州", "VARNAME_1": "Gùizhōu"}
#&gt; 2                                              {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.1_1", "HASC_1": "CN.AH", "NAME_0": "China", "NAME_1": "Anhui", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "安徽|安徽", "VARNAME_1": "Ānhuī"}
#&gt; 3                                  {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.2_1", "HASC_1": "CN.BJ", "NAME_0": "China", "NAME_1": "Beijing", "TYPE_1": "Zhíxiáshì", "ENGTYPE_1": "Municipality", "NL_NAME_1": "北京|北京", "VARNAME_1": "Běijīng"}
#&gt; 4                              {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.3_1", "HASC_1": "CN.CQ", "NAME_0": "China", "NAME_1": "Chongqing", "TYPE_1": "Zhíxiáshì", "ENGTYPE_1": "Municipality", "NL_NAME_1": "重慶|重庆", "VARNAME_1": "Chóngqìng"}
#&gt; 5                                                 {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.4_1", "HASC_1": "CN.FJ", "NAME_0": "China", "NAME_1": "Fujian", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "福建", "VARNAME_1": "Fújiàn"}
#&gt; 6                                              {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.5_1", "HASC_1": "CN.GS", "NAME_0": "China", "NAME_1": "Gansu", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "甘肅|甘肃", "VARNAME_1": "Gānsù"}
#&gt; 7                                      {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.6_1", "HASC_1": "CN.GD", "NAME_0": "China", "NAME_1": "Guangdong", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "廣東|广东", "VARNAME_1": "Guǎngdōng"}
#&gt; 8  {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.7_1", "HASC_1": "CN.GX", "NAME_0": "China", "NAME_1": "Guangxi", "TYPE_1": "Zìzhìqu", "ENGTYPE_1": "Autonomous Region", "NL_NAME_1": "廣西壯族自治區|广西壮族自治区", "VARNAME_1": "Guǎngxī Zhuàngzú"}
#&gt; 9                                                 {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.9_1", "HASC_1": "CN.HA", "NAME_0": "China", "NAME_1": "Hainan", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "海南", "VARNAME_1": "Hǎinán"}
#&gt; 10                                                 {"CC_1": null, "GID_0": "CHN", "GID_1": "CHN.10_1", "HASC_1": "CN.HB", "NAME_0": "China", "NAME_1": "Hebei", "TYPE_1": "Shěng", "ENGTYPE_1": "Province", "NL_NAME_1": "河北", "VARNAME_1": "Héběi"}
#&gt;                          geometry
#&gt; 1  MULTIPOLYGON (((109.5513 26...
#&gt; 2  POLYGON ((116.5815 30.04759...
#&gt; 3  POLYGON ((116.2377 39.51794...
#&gt; 4  POLYGON ((109.232 28.8789, ...
#&gt; 5  MULTIPOLYGON (((120.7168 26...
#&gt; 6  POLYGON ((101.7742 33.54804...
#&gt; 7  MULTIPOLYGON (((109.7414 21...
#&gt; 8  MULTIPOLYGON (((108.4797 21...
#&gt; 9  MULTIPOLYGON (((109.5334 19...
#&gt; 10 MULTIPOLYGON (((115.1205 36...</code></pre>
</div>
<div id="merge-administrative-division-and-epidemiology-data" class="section level2">
<h2 class="hasAnchor">
<a href="#merge-administrative-division-and-epidemiology-data" class="anchor"></a>Merge administrative division and epidemiology data</h2>
<p>Using the epidemiology data and the spatial layer we’ve retrieved, we create an overall spatial layer object for epidemiology data.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co">## Load sf package for spatial objects</span>
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)

<span class="no">chn_recent_region</span> <span class="kw">&lt;-</span> <span class="no">chn_recent_region</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">gid</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span>(<span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span>(<span class="kw">string</span> <span class="kw">=</span> <span class="no">gid</span>,
                                                    <span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"\\{|\\}"</span>))) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">chn_admin_1</span>, <span class="kw">by</span> <span class="kw">=</span> <span class="st">"gid"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_as_sf.html">st_as_sf</a></span>()</pre></body></html></div>
<pre><code>#&gt; Simple feature collection with 31 features and 20 fields
#&gt; geometry type:  GEOMETRY
#&gt; dimension:      XY
#&gt; bbox:           xmin: 73.5577 ymin: 18.15931 xmax: 134.7716 ymax: 53.56004
#&gt; geographic CRS: WGS 84
#&gt; # A tibble: 31 x 21
#&gt;    adm_area_1.x date       country.x confirmed recovered  dead gid   country.y
#&gt;    &lt;chr&gt;        &lt;date&gt;     &lt;chr&gt;         &lt;int&gt;     &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;chr&gt;    
#&gt;  1 Anhui        2020-03-31 China           990       984     6 CHN.… China    
#&gt;  2 Beijing      2020-04-01 China           580       418     8 CHN.… China    
#&gt;  3 Chongqing    2020-03-31 China           579       570     6 CHN.… China    
#&gt;  4 Fujian       2020-03-30 China           343       295     1 CHN.… China    
#&gt;  5 Gansu        2020-03-31 China           137       127     2 CHN.… China    
#&gt;  6 Guangdong    2020-03-31 China          1501      1357     8 CHN.… China    
#&gt;  7 Guangxi      2020-03-31 China           255       250     2 CHN.… China    
#&gt;  8 Guizhou      2020-03-31 China           147       144     2 CHN.… China    
#&gt;  9 Hainan       2020-03-30 China           168       162     6 CHN.… China    
#&gt; 10 Hebei        2020-03-30 China           321       310     6 CHN.… China    
#&gt; # … with 21 more rows, and 13 more variables: countrycode &lt;chr&gt;,
#&gt; #   countrycode_alpha2 &lt;chr&gt;, adm_level &lt;int&gt;, adm_area_1.y &lt;chr&gt;,
#&gt; #   adm_area_1_code &lt;chr&gt;, adm_area_2 &lt;chr&gt;, adm_area_2_code &lt;chr&gt;,
#&gt; #   adm_area_3 &lt;chr&gt;, adm_area_3_code &lt;chr&gt;, latitude &lt;dbl&gt;, longitude &lt;dbl&gt;,
#&gt; #   properties &lt;pq_jsonb&gt;, geometry &lt;GEOMETRY [°]&gt;</code></pre>
</div>
<div id="plot-epidemiology-total-confirmed" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-epidemiology-total-confirmed" class="anchor"></a>Plot epidemiology total confirmed</h2>
<p>Using the spatial layer object of epidemiology data in subnational units of China, we can create choropleth maps. Here we map the confirmed cases per subnational unit in China.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">chn_recent_region</span> <span class="kw">&lt;-</span> <span class="no">chn_recent_region</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">confirmed_class</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">chn_recent_region</span>$<span class="no">confirmed</span>,
                               <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">chn_recent_region</span>$<span class="no">confirmed</span>,
                                                 <span class="kw">probs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">0</span>,
                                                             <span class="kw">to</span> <span class="kw">=</span> <span class="fl">1</span>,
                                                             <span class="kw">by</span> <span class="kw">=</span> <span class="fl">0.1</span>)),
                               <span class="kw">include.lowest</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">chn_recent_region</span>$<span class="no">confirmed_class</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">chn_recent_region</span>$<span class="no">confirmed_class</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">","</span>, <span class="kw">replacement</span> <span class="kw">=</span> <span class="st">" - "</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"1.26e\\+03"</span>, <span class="kw">replacement</span> <span class="kw">=</span> <span class="st">"1257"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"6.78e\\+04"</span>, <span class="kw">replacement</span> <span class="kw">=</span> <span class="st">"67802"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"\\[|\\]|\\("</span>)

<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="no">chn_recent_region</span>[<span class="st">"confirmed_class"</span>],
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">""</span>,
     <span class="kw">pal</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw">colors</span> <span class="kw">=</span> <span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">5</span>,
                                                              <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Reds"</span>))(<span class="fl">10</span>),
     <span class="kw">nbreaks</span> <span class="kw">=</span> <span class="fl">10</span>,
     <span class="kw">breaks</span> <span class="kw">=</span> <span class="st">"quantile"</span>,
     <span class="kw">key.width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">lcm</a></span>(<span class="fl">5</span>))</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example5a-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="plot-epidemiology-total-death" class="section level2">
<h2 class="hasAnchor">
<a href="#plot-epidemiology-total-death" class="anchor"></a>Plot epidemiology total death</h2>
<p>Here we map the deaths per subnational unit in China.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">chn_recent_region</span> <span class="kw">&lt;-</span> <span class="no">chn_recent_region</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">dead_class</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span>(<span class="no">chn_recent_region</span>$<span class="no">dead</span>,
                               <span class="kw">breaks</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html">unique</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">chn_recent_region</span>$<span class="no">dead</span>,
                                                <span class="kw">probs</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="kw">from</span> <span class="kw">=</span> <span class="fl">0</span>,
                                                            <span class="kw">to</span> <span class="kw">=</span> <span class="fl">1</span>,
                                                            <span class="kw">by</span> <span class="kw">=</span> <span class="fl">0.1</span>),
                                                 <span class="kw">na.rm</span> <span class="kw">=</span> <span class="fl">TRUE</span>)),
                               <span class="kw">include.lowest</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">chn_recent_region</span>$<span class="no">dead_class</span>) <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(<span class="no">chn_recent_region</span>$<span class="no">dead_class</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">","</span>, <span class="kw">replacement</span> <span class="kw">=</span> <span class="st">" - "</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"3.19e\\+03"</span>, <span class="kw">replacement</span> <span class="kw">=</span> <span class="st">"3193"</span>) <span class="kw">%&gt;%</span>
  <span class="kw pkg">stringr</span><span class="kw ns">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html">str_remove_all</a></span>(<span class="kw">pattern</span> <span class="kw">=</span> <span class="st">"\\[|\\]|\\("</span>)

<span class="fu"><a href="https://rdrr.io/pkg/sf/man/plot.html">plot</a></span>(<span class="no">chn_recent_region</span>[<span class="st">"dead_class"</span>],
     <span class="kw">main</span> <span class="kw">=</span> <span class="st">""</span>,
     <span class="kw">pal</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span>(<span class="kw">colors</span> <span class="kw">=</span> <span class="kw pkg">RColorBrewer</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span>(<span class="kw">n</span> <span class="kw">=</span> <span class="fl">5</span>,
                                                              <span class="kw">name</span> <span class="kw">=</span> <span class="st">"Reds"</span>))(<span class="fl">7</span>),
     <span class="kw">nbreaks</span> <span class="kw">=</span> <span class="fl">7</span>,
     <span class="kw">breaks</span> <span class="kw">=</span> <span class="st">"quantile"</span>,
     <span class="kw">key.width</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/layout.html">lcm</a></span>(<span class="fl">5</span>))</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example6a-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="check-monotonicity-of-data---confirmed" class="section level2">
<h2 class="hasAnchor">
<a href="#check-monotonicity-of-data---confirmed" class="anchor"></a>Check monotonicity of data - confirmed</h2>
<p>In the example from the Oxford COVID-19 Database, epidemiology data was checked for monotonicity. It is expected that epidemiology data is monotonic as these variables are expected to increase over time given that the information is cumulative. Monotonicity was checked by plotting a time series of cases and deaths with the expectation that the line plots will be on an increasing trajectory over time. Any instance of dips in the time series would indicate violation of monotonicity and an indication of issues with the data.</p>
<p>In the Oxford COVID-19 Database example, time series line plot for each subnational unit was plotted on the same axis as shown below.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)

<span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">date</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">date</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">confirmed</span>, <span class="kw">colour</span> <span class="kw">=</span> <span class="no">adm_area_1</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_colour_discrete.html">scale_colour_discrete</a></span>(<span class="kw">name</span> <span class="kw">=</span> <span class="kw">NULL</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>()</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example7a-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Given that Hubei province had the most cases compared to all subnational units, the plot shows one time series curve with significantly more cases that anywhere else whilst all other units had a flat time series curve. This is not necessarily a good way to check monotonicity in all units as only Hubei province time series information is shown clearly.</p>
<p>In the plot below, we try to more clearly distinguish the time series for each subnational unit by showing a line plot for each unit separate. However, this only solves the issue of time series line plots being clearly demarcated from others. The curves, however, still does not show the true pattern for all units other than Hubei.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">date</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">date</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">confirmed</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>( ~ <span class="no">adm_area_1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example7b-1.png" width="960" style="display: block; margin: auto;"></p>
<p>We address this by allowing the y-axis for each subnational time series plot to be appropriate for the data for the specific unit as below. Here we are able to see the time series plots for each subunit and able to verify whether monotonicity is observed.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">date</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">date</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">confirmed</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>( ~ <span class="no">adm_area_1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example7c-1.png" width="960" style="display: block; margin: auto;"></p>
<p>Unfortunately, one subnational unit (Shaanxi Province) has a dip in cases within the time series plot which breaks monotonicity. This would indicate something inconsistent with the data. This needs to be checked.</p>
</div>
<div id="check-monotonicity-of-data---dead" class="section level2">
<h2 class="hasAnchor">
<a href="#check-monotonicity-of-data---dead" class="anchor"></a>Check monotonicity of data - dead</h2>
<p>In the next plots, we perform the same procedures but with the data on deaths. All subnational units demonstrate monotonicity with regard to number of deaths.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">date</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">date</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">dead</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>( ~ <span class="no">adm_area_1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example8a-1.png" width="960" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/connect_oxcovid19.html">connect_oxcovid19</a></span>() <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/get_table.html">get_table</a></span>(<span class="kw">tbl_name</span> <span class="kw">=</span> <span class="st">"epidemiology"</span>) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">source</span> <span class="kw">==</span> <span class="st">"CHN_ICL"</span>,
         !<span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">adm_area_1</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span>(<span class="no">date</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw">mapping</span> <span class="kw">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">date</span>, <span class="kw">y</span> <span class="kw">=</span> <span class="no">dead</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span>() +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span>( ~ <span class="no">adm_area_1</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">4</span>, <span class="kw">scales</span> <span class="kw">=</span> <span class="st">"free_y"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span>()</pre></body></html></div>
<p><img src="visualisation_china_files/figure-html/example8b-1.png" width="960" style="display: block; margin: auto;"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Ernest Guevarra, Chris Mercado, Robert Medina, Alexander Zarebski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
